<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Cardápio Bar - AFPESP Peruíbe II</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --gold: #c5a059;
      --dark-brown: #3d241f;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background-color: #1a1110;
      overflow: hidden;
      overscroll-behavior: none;
      -webkit-tap-highlight-color: transparent;
      display: flex;
      flex-direction: column;
    }

    header.top-bar {
      flex-shrink: 0;
      height: 45px;
      background: #000;
      display: flex;
      align-items: center;
      padding: 0 15px;
      z-index: 100;
    }

    section.title-bar {
      flex-shrink: 0;
      background-color: #333436;
      padding: 6px 10px;
      text-align: center;
      z-index: 90;
    }
    section.title-bar h1 { color: #00ff00; font-size: 13px; font-weight: bold; text-transform: uppercase; margin: 0; }

    #root {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 5px;
      min-height: 0;
      position: relative;
    }

    #book-container {
      position: relative;
      width: 98%;
      max-width: 1000px;
      height: 75vh; /* Altura fixa relativa para evitar cortes */
      margin: auto;
      perspective: 2000px;
      -webkit-perspective: 2000px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .transform-style-3d { 
      transform-style: preserve-3d; 
      -webkit-transform-style: preserve-3d;
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    .sheet {
      position: absolute;
      top: 0;
      left: 50%;
      width: 50%;
      height: 100%;
      transform-origin: left;
      transition: transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
      -webkit-transition: -webkit-transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1);
      z-index: 10;
      pointer-events: none; /* Só habilita nas faces visíveis */
    }

    .sheet.flipped {
      transform: rotateY(-180deg);
      -webkit-transform: rotateY(-180deg);
    }

    .backface-hidden { 
      backface-visibility: hidden; 
      -webkit-backface-visibility: hidden;
      transform: translateZ(0); /* Força aceleração de hardware */
      -webkit-transform: translateZ(0);
    }

    .bg-texture-paper { background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png'); background-color: #fdfbf7; }
    .bg-texture-leather { background-image: url('https://www.transparenttextures.com/patterns/leather.png'); }

    .menu-item {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      width: 100%;
      gap: 3px;
    }
    .item-dots {
      flex-grow: 1;
      border-bottom: 2px dotted rgba(0, 0, 0, 0.1);
      min-width: 4px;
      margin-bottom: 3px;
    }

    .custom-scrollbar {
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch !important;
      touch-action: pan-y !important;
      height: 100%;
      width: 100%;
    }

    .flip-zone {
      position: absolute;
      top: 0;
      width: 40%;
      height: 100%;
      z-index: 5000;
      cursor: pointer;
    }
    .flip-zone-right { right: 0; }
    .flip-zone-left { left: 0; }

    .font-serif { font-family: 'Cinzel', serif; }

    @media (max-width: 640px) {
      #book-container { 
        height: 70vh;
      }
      .p-page { padding: 12px !important; }
      .p-header { padding: 15px 5px !important; }
    }

    @media (max-height: 550px) {
      #book-container { height: 60vh; }
      header.top-bar { height: 35px; }
      section.title-bar { padding: 2px; }
      .mt-4 { margin-top: 0.5rem; }
    }
  </style>
</head>
<body>

  <header class="top-bar">
    <img src="https://i.ibb.co/R4jn242d/afpesp-2.png" alt="Logo AFPESP" style="height: 20px;" />
    <span style="color:white; font-weight:bold; margin-left:10px; font-size:12px;">AFPESP Peruíbe II</span>
  </header>

  <section class="title-bar">
    <h1>Cardápio Bar - AFPESP Peruíbe II</h1>
  </section>

  <div id="root">
    <div id="book-container">
      <div id="book" class="transform-style-3d"></div>
    </div>

    <div class="flex items-center justify-center gap-5 mt-3 mb-2 sm:hidden flex-shrink-0">
      <button id="prevBtn" onclick="prevPage()" class="p-2 bg-[#3d241f] rounded-full text-[#c5a059]"> 
        <i data-lucide="chevron-left" class="w-5 h-5"></i> 
      </button>
      <span id="page-indicator" class="text-[#c5a059] font-bold font-serif text-[10px] tracking-widest min-w-[50px] text-center">1 / 1</span>
      <button id="nextBtn" onclick="nextPage()" class="p-2 bg-[#3d241f] rounded-full text-[#c5a059]"> 
        <i data-lucide="chevron-right" class="w-5 h-5"></i> 
      </button>
    </div>
  </div>

  <script>
    const MENU_DATA = [
      { type: 'cover', title: 'MENU BAR', subtitle: 'AFPESP Peruíbe II' },
      { type: 'image', url: 'https://images.unsplash.com/photo-1546171753-97d7676e4602?q=80&w=800', caption: 'Bebidas Geladas' },
      { 
        type: 'content', 
        sections: [
          {
            title: 'Doses',
            icon: 'glass-water',
            items: [
              { n: 'Pinga 51', p: '4,00' }, { n: 'Velho Barreiro', p: '4,00' },
              { n: 'Sagatiba', p: '5,00' }, { n: 'Saquê', p: '6,00' },
              { n: 'Vodka (Caipiroska)', p: '5,00' }, { n: 'Campari', p: '7,00' }
            ]
          },
          {
            title: 'Caipirinhas',
            icon: 'martini',
            items: [
              { n: 'Pinga 51', p: '20,00' }, { n: 'Velho Barreiro', p: '15,00' },
              { n: 'Sagatiba', p: '25,00' }, { n: 'Saquê', p: '18,00' },
              { n: 'Vodka (Caipiroska)', p: '25,00' }
            ]
          },
          {
            title: 'Cervejas',
            icon: 'beer',
            items: [
              { n: 'Skol', p: '7,00' }, { n: 'Brahma', p: '7,00' },
              { n: 'Brahma Malzbier', p: '9,00' }, { n: 'Heineken', p: '10,00' },
              { n: 'Heineken sem álcool', p: '10,00' }
            ]
          }
        ]
      },
      { type: 'image', url: 'https://images.unsplash.com/photo-1506377247377-2a5b3b417ebb?q=80&w=1000', caption: 'Vinhos & Momentos' },
      { 
        type: 'content', 
        sections: [
          {
            title: 'Chopp',
            icon: 'beer',
            items: [
              { n: 'Chopp Claro', p: '9,00', d: '330ml' },
              { n: 'Chopp Claro', p: '13,50', d: '500ml' },
              { n: 'Chopp Escuro', p: '30,00', d: 'Garrafa 1L' }
            ]
          },
          {
            title: 'Vinhos',
            icon: 'wine',
            items: [
              { n: 'Vinho Tinto Seco', p: '8,00' }, { n: 'Vinho Tinto Suave', p: '8,00' },
              { n: 'Concha y Toro Tinto Meio Seco', p: '50,00' },
              { n: 'Periquita Tinto Meio Seco', p: '90,00' },
              { n: 'Santa Helena Chardonnay', p: '52,00' }
            ]
          },
          {
            title: 'Batidas',
            icon: 'martini',
            items: [
              { n: 'Pinga 51', p: '20,00' }, { n: 'Velho Barreiro', p: '20,00' },
              { n: 'Sagatiba', p: '25,00' }, { n: 'Saquê', p: '20,00' },
              { n: 'Vodka (Caipiroska)', p: '25,00' }, { n: 'Espanhola (Morango)', p: '18,00' }
            ]
          }
        ]
      },
      { type: 'image', url: 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?q=80&w=1000', caption: 'Refresco Gelado' },
      { 
        type: 'content', 
        sections: [
          {
            title: 'Bebidas não alcoólicas',
            icon: 'glass-water',
            items: [
              { n: 'Água com gás', p: '5,00' }, { n: 'Água sem gás', p: '5,00' },
              { n: 'Coca-Cola', p: '7,00' }, { n: 'Coca-Cola Zero', p: '7,00' },
              { n: 'Guaraná', p: '6,00' }, { n: 'Guaraná Zero', p: '6,00' },
              { n: 'Schweppes', p: '7,00' }, { n: 'Água Tônica', p: '6,00' },
              { n: 'Água Tônica Zero', p: '6,00' }, { n: 'H2O Limão', p: '7,00' },
              { n: 'Pacote de Gelo (3kg)', p: '6,00' }
            ]
          }
        ]
      },
      { type: 'image', url: 'https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?q=80&w=1000', caption: 'Energia Natural' },
      { 
        type: 'content', 
        sections: [
          {
            title: 'Sucos Naturais',
            icon: 'glass-water',
            items: [
              { n: 'Suco de Laranja', p: '10,00' }, { n: 'Suco de Limão', p: '10,00' },
              { n: 'Suco de Melancia', p: '10,00' },
              { n: 'Suco de Laranja', p: '18,00', d: 'Jarra' },
              { n: 'Suco de Limão', p: '18,00', d: 'Jarra' },
              { n: 'Suco de Melancia', p: '18,00', d: 'Jarra' }
            ]
          },
          {
            title: 'Sucos (Outros)',
            icon: 'glass-water',
            items: [
              { n: 'Suco de Uva', p: '15,00', d: 'Integral – Copo' },
              { n: 'Suco de Uva', p: '8,00', d: 'Del Valle – Lata' },
              { n: 'Suco de Pêssego', p: '8,00', d: 'Del Valle – Lata' }
            ]
          },
          {
            title: 'Especiais',
            icon: 'coffee',
            items: [
              { n: 'Copo de Leite Longo', p: '5,00' }, { n: 'Café Expresso Pequeno', p: '5,00' },
              { n: 'Espanhola Sem Álcool', p: '8,00', d: 'Drink' },
              { n: 'Especial Peruíbe II', p: '8,00', d: 'Drink sem álcool' }
            ]
          }
        ]
      },
      { type: 'image', url: 'https://i.ibb.co/99h3wM28/porcao-de-camarao-frito.jpg', caption: 'Petiscos Deliciosos' },
      { 
        type: 'content', 
        sections: [
          {
            title: 'Porções',
            icon: 'utensils',
            items: [
              { n: 'Batata Frita', p: '15,00', d: '200g' }, { n: 'Batata Frita', p: '20,00', d: '400g' },
              { n: 'Camarão', p: '40,00', d: '250g' }, { n: 'Camarão', p: '55,00', d: '500g' },
              { n: 'Isca de Peixe', p: '45,00', d: '500g' }, { n: 'Calabresa Acebolada', p: '18,00', d: '400g' }
            ]
          },
          {
            title: 'Lanches',
            icon: 'utensils',
            items: [
              { n: 'Misto Quente', p: '7,00' }, { n: 'Misto Frio', p: '10,00' },
              { n: 'Queijo Quente', p: '10,00' }
            ]
          },
          {
            title: 'Pratos Extras',
            icon: 'utensils',
            items: [
              { n: 'Omelete', p: '4,00' }, { n: 'Omelete com Queijo', p: '5,00' },
              { n: 'Ovo Cozido', p: '2,00' }, { n: 'Ovo Frito', p: '3,00' },
              { n: 'Filé de Frango', p: '5,00' }, { n: 'Bife Grelhado', p: '9,00' }
            ]
          }
        ]
      },
      { type: 'back', title: 'VOLTE SEMPRE', subtitle: 'Obrigado pela preferência' }
    ];

    let currentSheet = 0;
    const book = document.getElementById('book');
    const container = document.getElementById('book-container');
    const sheets = [];

    function initBook() {
      book.innerHTML = '';
      sheets.length = 0;
      for (let i = 0; i < MENU_DATA.length; i += 2) {
        const sheet = document.createElement('div');
        sheet.className = 'sheet transform-style-3d';
        sheet.style.zIndex = Math.floor((MENU_DATA.length - i) / 2) + 10;
        
        const front = document.createElement('div');
        front.id = `front-${i/2}`;
        front.className = 'absolute inset-0 w-full h-full backface-hidden bg-texture-paper border-r border-black/10 shadow-lg overflow-hidden';
        front.style.pointerEvents = 'auto';
        front.innerHTML = renderPage(MENU_DATA[i]);
        
        const flipR = document.createElement('div');
        flipR.className = 'flip-zone flip-zone-right';
        flipR.onclick = (e) => { e.stopPropagation(); nextPage(); };
        front.appendChild(flipR);

        const back = document.createElement('div');
        back.id = `back-${i/2}`;
        back.className = 'absolute inset-0 w-full h-full backface-hidden bg-texture-paper border-l border-black/10 shadow-lg overflow-hidden';
        back.style.transform = 'rotateY(180deg) translateZ(0.1px)'; // Pequeno offset para evitar flicker
        back.style.webkitTransform = 'rotateY(180deg) translateZ(0.1px)';
        back.style.pointerEvents = 'none'; 
        back.innerHTML = MENU_DATA[i+1] ? renderPage(MENU_DATA[i+1]) : '<div class="h-full bg-[#3d241f]"></div>';
        
        const flipL = document.createElement('div');
        flipL.className = 'flip-zone flip-zone-left'; 
        flipL.onclick = (e) => { e.stopPropagation(); prevPage(); };
        back.appendChild(flipL);

        sheet.appendChild(front);
        sheet.appendChild(back);
        book.appendChild(sheet);
        sheets.push(sheet);
      }
      updateIndicator();
      lucide.createIcons();
      // Revela o livro apenas após montar tudo para evitar flicker de ícones
      setTimeout(() => { container.style.opacity = '1'; }, 100);
    }

    function renderPage(data) {
      if (data.type === 'cover' || data.type === 'back') {
        const icon = data.type === 'cover' ? 'chef-hat' : 'heart';
        const isBack = data.type === 'back';
        const titleSize = isBack ? 'text-xl sm:text-5xl' : 'text-3xl sm:text-5xl';
        const subtitleSize = isBack ? 'text-[11px] sm:text-[18px]' : 'text-[10px] sm:text-sm';

        return `<div class="h-full w-full flex flex-col items-center justify-center bg-[#3d241f] text-[#c5a059] p-header p-4 text-center relative overflow-hidden">
                  <div class="absolute inset-0 bg-texture-leather opacity-20 pointer-events-none"></div>
                  <div class="relative z-10 flex flex-col items-center w-full max-w-[90%]">
                    <i data-lucide="${icon}" class="w-10 h-10 sm:w-16 sm:h-16 mb-4"></i>
                    <h1 class="font-serif ${titleSize} font-bold uppercase mb-4 w-full leading-tight">${data.title}</h1>
                    <div class="w-10 h-1 bg-[#c5a059] mb-6"></div>
                    <p class="font-serif ${subtitleSize} opacity-90 uppercase tracking-[0.1em] leading-relaxed">${data.subtitle}</p>
                  </div>
                </div>`;
      }
      if (data.type === 'image') {
        return `<div class="h-full relative overflow-hidden bg-[#000]">
                  <div class="absolute inset-0 bg-cover bg-center" style="background-image:url('${data.url}')"></div>
                  <div class="absolute inset-0 bg-black/40"></div>
                  <div class="absolute bottom-5 left-0 right-0 text-center text-white px-2">
                    <h3 class="font-serif text-[10px] sm:text-lg tracking-widest uppercase mb-1">${data.caption}</h3>
                    <div class="w-6 h-0.5 bg-[#c5a059] mx-auto"></div>
                  </div>
                </div>`;
      }
      
      const sectionsHtml = data.sections.map(s => `
        <div class="mb-5 sm:mb-8">
          <h3 class="font-serif text-[10px] sm:text-[13px] font-bold text-gray-500 mb-2 border-b border-[#c5a059]/30 pb-1 flex items-center gap-2 uppercase tracking-wider">
            <i data-lucide="${s.icon}" class="w-3 h-3 text-[#3d241f]"></i> ${s.title}
          </h3>
          ${s.items.map(item => `
            <div class="mb-2">
              <div class="menu-item">
                <span class="font-bold text-gray-800 text-[10px] sm:text-[14px] leading-tight flex-1 pr-1">${item.n}</span>
                <div class="item-dots"></div>
                <span class="font-serif font-bold text-gray-900 text-[10px] sm:text-[14px] whitespace-nowrap">R$ ${item.p}</span>
              </div>
              ${item.d ? `<div class="text-[8px] sm:text-[10px] text-gray-400 italic mt-[-1px]">${item.d}</div>` : ''}
            </div>
          `).join('')}
        </div>
      `).join('');

      return `<div class="h-full bg-texture-paper flex flex-col p-page p-4 sm:p-10 relative overflow-hidden">
                <div class="custom-scrollbar pr-1">
                  <div class="pb-6 pt-1">${sectionsHtml}</div>
                </div>
              </div>`;
    }

    function nextPage() {
      if (currentSheet < sheets.length) {
        const sheet = sheets[currentSheet];
        sheet.classList.add('flipped');
        document.getElementById(`front-${currentSheet}`).style.pointerEvents = 'none';
        document.getElementById(`back-${currentSheet}`).style.pointerEvents = 'auto';
        sheet.style.zIndex = 100 + currentSheet;
        currentSheet++;
        updateIndicator();
      }
    }

    function prevPage() {
      if (currentSheet > 0) {
        currentSheet--;
        const sheet = sheets[currentSheet];
        sheet.classList.remove('flipped');
        document.getElementById(`front-${currentSheet}`).style.pointerEvents = 'auto';
        document.getElementById(`back-${currentSheet}`).style.pointerEvents = 'none';
        sheet.style.zIndex = 200 - currentSheet;
        updateIndicator();
      }
    }

    function updateIndicator() {
      const indicator = document.getElementById('page-indicator');
      if (indicator) {
        indicator.innerText = `${currentSheet + 1} / ${sheets.length}`;
      }
    }

    function updateBookSize() {
      const cont = document.getElementById('book-container');
      if (!cont) return;
      cont.style.aspectRatio = window.innerWidth < 640 ? "0.7/1" : "2.1/1";
    }

    window.addEventListener('resize', updateBookSize);
    updateBookSize();
    initBook();
  </script>
</body>
</html>
